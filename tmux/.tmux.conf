set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

run '~/.tmux/plugins/tpm/tpm'

# Terminal overrides for proper color and theme support
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'


set-option -g detach-on-destroy off

# Enable focus events so vim can detect background changes
set -g focus-events on

# Allow background color to be updated
set -ga update-environment 'TERM_PROGRAM'

unbind '"'
unbind %

bind r source-file ~/.tmux.conf \; display "Reloaded!"

# splits
bind - split-window -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"

# Pane navigation (vim-like)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Quick pane switching with Alt+arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Window navigation
bind n new-window
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

bind H select-window -t :-  # left
bind L select-window -t :+  # right

# Easy window navigation with prefix+number
bind 0 select-window -t 0
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3

# # Previous/next window
# bind p previous-window
# bind n next-window

# Session navigation
bind S command-prompt "switch-client -t %%"  # Quick session switch
bind K confirm-before -p "kill-session #S? (y/n)" kill-session
bind N command-prompt "new-session -s '%%'"
bind -r p run-shell "tmux neww ~/bin/tmux-sessionizer"
bind P choose-tree

# Toggle between the last two windows
bind Space last-window

# Enter copy mode with prefix+[
bind [ copy-mode

## Referece
# bind g display-popup -E -w 90% -h 80% "lazygit"  # for floating windows
# bind g split-window -h "lazygit"  # for vertical split

# urls https://github.com/wtfox/dotfiles.git
# <prefix> + Ctrl+u â†’ open urlscan in a tmux popup
bind -T prefix C-u display-popup -E -w 90% -h 80% "sh -lc 'tmux capture-pane -J -p -S  ! | urlview'"
bind g new-window "lazygit"
bind c new-window "claude"
bind b new-window "btop"

# Mouse mode (for easy scrolling and selection)
set -g mouse on

# Vim-like key bindings in copy mode
setw -g mode-keys vi

# Theme Selection
set -g @jellybeans_flavour 'jellybeans'                      # Theme flavor

# Status Line Components
set -g @jellybeans_show_battery 'off'                        # Show battery indicator
set -g @jellybeans_battery_icon 'ðŸ”‹'                         # Battery icon
set -g @jellybeans_show_user 'on'                            # Show username
set -g @jellybeans_show_host 'on'                            # Show hostname
set -g @jellybeans_show_window_flags 'off'                   # Show window flags
set -g @jellybeans_status_modules_right 'battery date'       # Right status modules
set -g @jellybeans_status_modules_left 'session user host'   # Left status modules

# Format Options
set -g @jellybeans_date_format '%Y-%m-%d'                    # Date format
set -g @jellybeans_time_format '%H:%M'                       # Time format

run-shell ~/.tmux/themes/jellybeans/jellybeans.tmux
